{"version":3,"sources":["../../../../../src/components/week/calendarWeekView.component.ts"],"names":[],"mappings":"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","file":"calendarWeekView.component.js","sourceRoot":"","sourcesContent":["import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  ChangeDetectorRef,\r\n  OnChanges,\r\n  OnInit,\r\n  OnDestroy,\r\n  LOCALE_ID,\r\n  Inject,\r\n  TemplateRef\r\n} from '@angular/core';\r\nimport { Subject } from 'rxjs/Subject';\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport {\r\n  WeekDay,\r\n  CalendarEvent,\r\n  WeekViewEvent,\r\n  WeekViewEventRow\r\n} from 'calendar-utils';\r\nimport { ResizeEvent } from 'angular-resizable-element';\r\nimport addDays from 'date-fns/add_days';\r\nimport differenceInDays from 'date-fns/difference_in_days';\r\nimport startOfDay from 'date-fns/start_of_day';\r\nimport { CalendarDragHelper } from '../../providers/calendarDragHelper.provider';\r\nimport { CalendarResizeHelper } from '../../providers/calendarResizeHelper.provider';\r\nimport { CalendarEventTimesChangedEvent } from '../../interfaces/calendarEventTimesChangedEvent.interface';\r\nimport { CalendarUtils } from '../../providers/calendarUtils.provider';\r\n\r\nexport interface CurrentResize {\r\n  originalOffset: number;\r\n  originalSpan: number;\r\n  edge: string;\r\n}\r\n\r\n/**\r\n * Shows all events on a given week. Example usage:\r\n *\r\n * ```typescript\r\n * &lt;mwl-calendar-week-view\r\n *  [viewDate]=\"viewDate\"\r\n *  [events]=\"events\"&gt;\r\n * &lt;/mwl-calendar-week-view&gt;\r\n * ```\r\n */\r\n\r\nexport class CalendarWeekViewComponent implements OnChanges, OnInit, OnDestroy {\r\n\r\n  /**\r\n   * The current view date\r\n   */\r\n   viewDate: Date;\r\n\r\n  /**\r\n   * An array of events to display on view\r\n   */\r\n   events: CalendarEvent[] = [];\r\n\r\n  /**\r\n   * An array of day indexes (0 = sunday, 1 = monday etc) that will be hidden on the view\r\n   */\r\n   excludeDays: number[] = [];\r\n\r\n  /**\r\n   * An observable that when emitted on will re-render the current view\r\n   */\r\n   refresh: Subject<any>;\r\n\r\n  /**\r\n   * The locale used to format dates\r\n   */\r\n   locale: string;\r\n\r\n  /**\r\n   * The placement of the event tooltip\r\n   */\r\n   tooltipPlacement: string = 'bottom';\r\n\r\n  /**\r\n   * The start number of the week\r\n   */\r\n   weekStartsOn: number;\r\n\r\n  /**\r\n   * A custom template to use to replace the header\r\n   */\r\n   headerTemplate: TemplateRef<any>;\r\n\r\n  /**\r\n   * A custom template to use for week view events\r\n   */\r\n   eventTemplate: TemplateRef<any>;\r\n\r\n  /**\r\n   * The precision to display events.\r\n   * `days` will round event start and end dates to the nearest day and `minutes` will not do this rounding\r\n   */\r\n   precision: 'days' | 'minutes' = 'days';\r\n\r\n  /**\r\n   * Allow events to be dragged outside of the calendar\r\n   */\r\n   allowDragOutside: boolean = false;\r\n\r\n  /**\r\n   * Called when a header week day is clicked\r\n   */\r\n   dayClicked: EventEmitter<{date: Date}> = new EventEmitter<{date: Date}>();\r\n\r\n  /**\r\n   * Called when the event title is clicked\r\n   */\r\n   eventClicked: EventEmitter<{event: CalendarEvent}> = new EventEmitter<{event: CalendarEvent}>();\r\n\r\n  /**\r\n   * Called when an event is resized or dragged and dropped\r\n   */\r\n   eventTimesChanged: EventEmitter<CalendarEventTimesChangedEvent> = new EventEmitter<CalendarEventTimesChangedEvent>();\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  days: WeekDay[];\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  eventRows: WeekViewEventRow[] = [];\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  refreshSubscription: Subscription;\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  currentResizes: Map<WeekViewEvent, CurrentResize> = new Map();\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  validateDrag: Function;\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  validateResize: Function;\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  constructor(private cdr: ChangeDetectorRef, private utils: CalendarUtils,  locale: string) {\r\n    this.locale = locale;\r\n  }\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  ngOnInit(): void {\r\n    if (this.refresh) {\r\n      this.refreshSubscription = this.refresh.subscribe(() => {\r\n        this.refreshAll();\r\n        this.cdr.markForCheck();\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  ngOnChanges(changes: any): void {\r\n\r\n    if (changes.viewDate || changes.excludeDays) {\r\n      this.refreshHeader();\r\n    }\r\n\r\n    if (changes.events || changes.viewDate || changes.excludeDays) {\r\n      this.refreshBody();\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  ngOnDestroy(): void {\r\n    if (this.refreshSubscription) {\r\n      this.refreshSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  resizeStarted(weekViewContainer: HTMLElement, weekEvent: WeekViewEvent, resizeEvent: ResizeEvent): void {\r\n    this.currentResizes.set(weekEvent, {\r\n      originalOffset: weekEvent.offset,\r\n      originalSpan: weekEvent.span,\r\n      edge: typeof resizeEvent.edges.left !== 'undefined' ? 'left' : 'right'\r\n    });\r\n    const resizeHelper: CalendarResizeHelper = new CalendarResizeHelper(weekViewContainer, this.getDayColumnWidth(weekViewContainer));\r\n    this.validateResize = ({rectangle}) => resizeHelper.validateResize({rectangle});\r\n    this.cdr.markForCheck();\r\n  }\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  resizing(weekEvent: WeekViewEvent, resizeEvent: ResizeEvent, dayWidth: number): void {\r\n\r\n    const currentResize: CurrentResize = this.currentResizes.get(weekEvent);\r\n\r\n    if (resizeEvent.edges.left) {\r\n      const diff: number = Math.round(+resizeEvent.edges.left / dayWidth);\r\n      weekEvent.offset = currentResize.originalOffset + diff;\r\n      weekEvent.span = currentResize.originalSpan - diff;\r\n    } else if (resizeEvent.edges.right) {\r\n      const diff: number = Math.round(+resizeEvent.edges.right / dayWidth);\r\n      weekEvent.span = currentResize.originalSpan + diff;\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  resizeEnded(weekEvent: WeekViewEvent): void {\r\n\r\n    const currentResize: CurrentResize = this.currentResizes.get(weekEvent);\r\n\r\n    let daysDiff: number;\r\n    if (currentResize.edge === 'left') {\r\n      daysDiff = weekEvent.offset - currentResize.originalOffset;\r\n    } else {\r\n      daysDiff = weekEvent.span - currentResize.originalSpan;\r\n    }\r\n\r\n    weekEvent.offset = currentResize.originalOffset;\r\n    weekEvent.span = currentResize.originalSpan;\r\n\r\n    let newStart: Date = weekEvent.event.start;\r\n    let newEnd: Date = weekEvent.event.end;\r\n    if (currentResize.edge === 'left') {\r\n      newStart = addDays(newStart, daysDiff);\r\n    } else if (newEnd) {\r\n      newEnd = addDays(newEnd, daysDiff);\r\n    }\r\n\r\n    this.eventTimesChanged.emit({newStart, newEnd, event: weekEvent.event});\r\n    this.currentResizes.delete(weekEvent);\r\n\r\n  }\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  eventDragged(weekEvent: WeekViewEvent, draggedByPx: number, dayWidth: number): void {\r\n\r\n    let daysDragged: number = Math.round(draggedByPx / dayWidth);\r\n    let newStart: Date = addDays(weekEvent.event.start, daysDragged);\r\n\r\n    if (this.allowDragOutside) {\r\n      // Restrict start to first and last day on current week\r\n      if (newStart < this.days[0].date) {\r\n        daysDragged += differenceInDays(startOfDay(this.days[0].date), startOfDay(newStart));\r\n      }\r\n      const lastDate: Date = this.days[this.days.length - 1].date;\r\n      if (newStart > lastDate) {\r\n        daysDragged -= differenceInDays(startOfDay(newStart), startOfDay(lastDate));\r\n      }\r\n    }\r\n\r\n    newStart = addDays(weekEvent.event.start, daysDragged);\r\n\r\n    let newEnd: Date;\r\n    if (weekEvent.event.end) {\r\n      newEnd = addDays(weekEvent.event.end, daysDragged);\r\n    }\r\n\r\n    this.eventTimesChanged.emit({newStart, newEnd, event: weekEvent.event});\r\n\r\n  }\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  getDayColumnWidth(eventRowContainer: HTMLElement): number {\r\n    return Math.floor(eventRowContainer.offsetWidth / this.days.length);\r\n  }\r\n\r\n  /**\r\n   * @hidden\r\n   */\r\n  dragStart(weekViewContainer: HTMLElement, event: HTMLElement): void {\r\n    if (!this.allowDragOutside) {\r\n      const dragHelper: CalendarDragHelper = new CalendarDragHelper(weekViewContainer, event);\r\n      this.validateDrag = ({x, y}) => this.currentResizes.size === 0 && dragHelper.validateDrag({x, y});\r\n      this.cdr.markForCheck();\r\n    }\r\n  }\r\n\r\n  private refreshHeader(): void {\r\n    this.days = this.utils.getWeekViewHeader({\r\n      viewDate: this.viewDate,\r\n      weekStartsOn: this.weekStartsOn,\r\n      excluded: this.excludeDays\r\n    });\r\n  }\r\n\r\n  private refreshBody(): void {\r\n    this.eventRows = this.utils.getWeekView({\r\n      events: this.events,\r\n      viewDate: this.viewDate,\r\n      weekStartsOn: this.weekStartsOn,\r\n      excluded: this.excludeDays,\r\n      precision: this.precision,\r\n      absolutePositionedEvents: true\r\n    });\r\n  }\r\n\r\n  private refreshAll(): void {\r\n    this.refreshHeader();\r\n    this.refreshBody();\r\n  }\r\n\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\r\n  selector: 'mwl-calendar-week-view',\r\n  template: `\r\n    <div class=\"cal-week-view\" #weekViewContainer>\r\n      <mwl-calendar-week-view-header\r\n        [days]=\"days\"\r\n        [locale]=\"locale\"\r\n        [customTemplate]=\"headerTemplate\"\r\n        (dayClicked)=\"dayClicked.emit($event)\"\r\n        (eventDropped)=\"eventTimesChanged.emit($event)\">\r\n      </mwl-calendar-week-view-header>\r\n      <div *ngFor=\"let eventRow of eventRows\" #eventRowContainer class=\"cal-events-row\">\r\n        <div\r\n          class=\"cal-event-container\"\r\n          #event\r\n          [class.cal-draggable]=\"weekEvent.event.draggable\"\r\n          *ngFor=\"let weekEvent of eventRow.row\"\r\n          [style.width]=\"((100 / days.length) * weekEvent.span) + '%'\"\r\n          [style.marginLeft]=\"((100 / days.length) * weekEvent.offset) + '%'\"\r\n          mwlResizable\r\n          [resizeEdges]=\"{left: weekEvent.event?.resizable?.beforeStart, right: weekEvent.event?.resizable?.afterEnd}\"\r\n          [resizeSnapGrid]=\"{left: getDayColumnWidth(eventRowContainer), right: getDayColumnWidth(eventRowContainer)}\"\r\n          [validateResize]=\"validateResize\"\r\n          (resizeStart)=\"resizeStarted(weekViewContainer, weekEvent, $event)\"\r\n          (resizing)=\"resizing(weekEvent, $event, getDayColumnWidth(eventRowContainer))\"\r\n          (resizeEnd)=\"resizeEnded(weekEvent)\"\r\n          mwlDraggable\r\n          [dragSnapGrid]=\"{x: allowDragOutside ? 0 : getDayColumnWidth(eventRowContainer)}\"\r\n          [validateDrag]=\"validateDrag\"\r\n          (dragStart)=\"dragStart(weekViewContainer, event)\"\r\n          [dragAxis]=\"{x: weekEvent.event.draggable && currentResizes.size === 0, y: allowDragOutside}\"\r\n          (dragEnd)=\"eventDragged(weekEvent, $event.x, getDayColumnWidth(eventRowContainer))\"\r\n          [dropData]=\"{event: weekEvent.event}\">\r\n          <mwl-calendar-week-view-event\r\n            [weekEvent]=\"weekEvent\"\r\n            [tooltipPlacement]=\"tooltipPlacement\"\r\n            [customTemplate]=\"eventTemplate\"\r\n            (eventClicked)=\"eventClicked.emit({event: weekEvent.event})\">\r\n          </mwl-calendar-week-view-event>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ChangeDetectorRef, },\n{type: CalendarUtils, },\n{type: undefined, decorators: [{ type: Inject, args: [LOCALE_ID, ] }, ]},\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'viewDate': [{ type: Input },],\n'events': [{ type: Input },],\n'excludeDays': [{ type: Input },],\n'refresh': [{ type: Input },],\n'locale': [{ type: Input },],\n'tooltipPlacement': [{ type: Input },],\n'weekStartsOn': [{ type: Input },],\n'headerTemplate': [{ type: Input },],\n'eventTemplate': [{ type: Input },],\n'precision': [{ type: Input },],\n'allowDragOutside': [{ type: Input },],\n'dayClicked': [{ type: Output },],\n'eventClicked': [{ type: Output },],\n'eventTimesChanged': [{ type: Output },],\n};\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}